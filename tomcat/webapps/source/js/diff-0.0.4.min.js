(function(b,c){if(!c||typeof c.create!=="function"){console.log("The diffWindow plugin requires $.window plugin");return}var a=function(){this.init=function(d,e){$.diffWindow=c.create($.extend({title:"Diff jumper",draggable:false,init:function(j){var h;var g;var i=this;i.options.$toggleButton.each(function(){i.$window.css({top:$(this).offset().top,left:$(this).offset().left+$(this).outerWidth(),opacity:0}).hide()});i.options.$toggleButton.click(function(l){i.initChanges();var k=$(this).data("animation-in-progress");if(k=="showing"){i.$window.stop().animate({top:i.options.$content.scrollTop()+$(this).offset().top,left:$(this).offset().left+$(this).outerWidth(),opacity:0},i.options.animationDuration,function(){i.$window.hide();$(this).data("animation-in-progress",null)});$(this).data("animation-in-progress","hiding")}else{i.$window.stop().show().animate({top:i.options.$content.scrollTop()+i.options.$parent.offset().top+10,left:$(b).outerWidth()-i.$window.outerWidth()-25,opacity:1},i.options.animationDuration,function(){$(this).data("animation-in-progress",null)});$(this).data("animation-in-progress","showing")}return false});var f=$('<div class="pull-right">').append(h=$('<a href="#" class="prev" title="Jump to previous chunk (shortcut b)"><< Previous</a>')).append('<span class="pull-rigt"> | </span>').append(g=$('<a href="#" class="next" title="Jump to next chunk (shortcut n)">Next >></a>')).append($('<div class="clearfix">'));g.click(function(k){i.nextHandler.apply(i,[k])});h.click(function(k){i.prevHandler.apply(i,[k])});j.find(".minimize").unbind("click").click(function(k){i.$window.stop().animate({top:i.options.$content.scrollTop()+i.options.$toggleButton.offset().top,left:i.options.$toggleButton.offset().left+i.options.$toggleButton.outerWidth(),opacity:0},i.options.animationDuration,function(){i.$window.hide();i.options.$toggleButton.data("animation-in-progress",null)});i.options.$toggleButton.data("animation-in-progress","hiding")});return j.attr("id","diff_win").addClass("diff-window").addClass("diff_navigation_style").css({top:"150px",right:"20px","min-width":"300px"}).body().append(f).append(this.$summary).append(this.$progress).window()},load:function(g){var f=this;$(document).keypress(function(i){if(textInputHasFocus()){return true}var h=i.keyCode||i.which;switch(h){case 110:f.nextHandler(i);break;case 98:f.prevHandler(i);break;default:}})},update:function(g){var f=this.currentIndex<0?1:(this.currentIndex+1);this.$summary.text(f+"/"+this.$changes.length+" chunks")}},d||{$parent:$("#content"),$content:$("#content"),chunkSelector:".chunk",addSelector:".a",delSelector:".d",$toggleButton:$("#toggle-jumper"),animationDuration:500}),$.extend({currentIndex:-1,$changes:$(),$progress:$("<div>").css("text-align","center"),$summary:$("<div>"),initChanges:function(){if(this.$changes.length){return}var f=this.options.$parent.find("table").length>0;this.$changes=f?this.options.$parent.find(this.options.chunkSelector):this.options.$parent.find(this.options.addSelector+","+this.options.delSelector);this.$window.update()},progress:function(g){var f=$("<p>"+g+"</p>").animate({opacity:"0.2"},1000);f.hide("fast",function(){f.remove()});this.$progress.html(f)},scrollTop:function(f){if(this.options.scrollTop){this.options.scrollTop(f)}else{$("html, body").stop().animate({scrollTop:f.position().top-this.options.$parent.offset().top},500)}return this},prevHandler:function(g){g.preventDefault();this.initChanges();var f=$(this.$changes[this.currentIndex-1]);if(!f.length){this.$window.error("No previous chunk!");return false}this.currentIndex--;this.progress("Going to chunk "+(this.currentIndex+1)+"/"+this.$changes.length);this.scrollTop(f);this.$window.update();return false},nextHandler:function(g){g.preventDefault();this.initChanges();var f=$(this.$changes[this.currentIndex+1]);if(!f.length){this.$window.error("No next chunk!");return false}this.currentIndex++;this.progress("Going to chunk "+(this.currentIndex+1)+"/"+this.$changes.length);this.scrollTop(f);this.$window.update();return false}},e||{}));return $.diffWindow}};$.diffWindow=new ($.extend(a,$.diffWindow?$.diffWindow:{}))()}(window,$.window));$(document).ready(function(){$.diffWindow.init()});